<!DOCTYPE html>
<html lang="en" xmlns:th="" xmlns:sec="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <!--  link   -->
    <th:block th:insert="fragments/link :: linkFragment" />

    <!-- join.css-->
    <link rel="stylesheet" href="/css/user/index_join.css">

    <link rel="stylesheet" href="/css/index_login.css">
    <!-- index.css-->
    <link rel="stylesheet" href="/css/index.css">


    <!-- index.js   -->
    <script src="/js/index.js" defer> </script>
    <script src="/js/user/index_join.js" defer> </script>

    <!-- chart.js    -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>


    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.14/index.global.min.js'></script>


    <script th:inline="javascript">
        let  list = /*[[${ list}]]*/
        let  list2 = /*[[${ list2}]]*/
        let  imageCountMap = /*[[${ imageCountMap}]]*/
        let  musicCountMap = /*[[${ musicCountMap}]]*/

        console.log("list",list);
        console.log("list2",list2);
        console.log("imageCountMap",imageCountMap);
        console.log("musicCountMap",musicCountMap);



        eventList = [];
        list.forEach(el=>{
            console.log(el);
            let eventObject=null;
            if(el.status=='경매승인')
                eventObject={id:el.tradingid,title:el.title,start:el.auctionStartTime,color:'gray'};
            else if(el.status=='경매중'){
                eventObject={id:el.tradingid,title:el.title,start:el.auctionStartTime,color:'green'};
            }else if(el.status=='경매중지'){
                eventObject={id:el.tradingid,title:el.title,start:el.auctionStartTime,color:'red'};
            }else if(el.status=='낙찰완료'){
                eventObject={id:el.tradingid,title:el.title,start:el.auctionStartTime,color:'orange'};
            }else if(el.status=='결제완료'){
                eventObject={id:el.tradingid,title:el.title,start:el.auctionStartTime,color:'blue'};
            }else if(el.status=='송금완료'){
                eventObject={id:el.tradingid,title:el.title,start:el.auctionStartTime,color:'darkcyan'};
            }else{
                eventObject={id:el.tradingid,title:el.title,start:el.auctionStartTime,color:'white'};
            }
            eventList.push(eventObject)
        });
        list2.forEach(el=>{
            console.log(el);
            let eventObject=null;
            if(el.status=='경매승인')
                eventObject={id:el.tradingid,title:el.title,start:el.auctionStartTime,color:'gray'};
            else if(el.status=='경매중'){
                eventObject={id:el.tradingid,title:el.title,start:el.auctionStartTime,color:'green'};
            }else if(el.status=='경매중지'){
                eventObject={id:el.tradingid,title:el.title,start:el.auctionStartTime,color:'red'};
            }else if(el.status=='낙찰완료'){
                eventObject={id:el.tradingid,title:el.title,start:el.auctionStartTime,color:'orange'};
            }else if(el.status=='결제완료'){
                eventObject={id:el.tradingid,title:el.title,start:el.auctionStartTime,color:'blue'};
            }else if(el.status=='송금완료'){
                eventObject={id:el.tradingid,title:el.title,start:el.auctionStartTime,color:'darkcyan'};
            }else{
                eventObject={id:el.tradingid,title:el.title,start:el.auctionStartTime,color:'white'};
            }
            eventList.push(eventObject)
        });

    </script>
    <script>
        var calendar = null;
        document.addEventListener('DOMContentLoaded', function() {

                  var calendarEl = document.getElementById('calendar');
                  calendar = new FullCalendar.Calendar(calendarEl, {
                    locale: "ko",
                    initialView: 'dayGridWeek',
                    selectable : false,
                    events : eventList,

                    //Date 클릭시 표시
                    dateClick : function(info){
                        console.log(info);
                        //addEventToCalendar({start:info.dateStr})
                    },
                    eventClick:function(info){
                        console.log(info.event._def);
                        const calenderEventModal = document.querySelector('.calenderEventModal');
                        calenderEventModal.click();
                        const exampleModal2= document.getElementById('exampleModal2');
                        const modelBody =  exampleModal2.querySelector('.modal-body');
                        modelBody.innerHTML = info.event._def;

                    },
                  });
                  calendar.render();
                  //기존 이벤트 업로드

                  calendarEl.style.height="300px";


        });

                function addEventToCalendar(event){
                    calendar.addEvent(event);
                };
    </script>


</head>
<body>
    
    <div class="wrapper">

        <!-- header   -->
        <th:block th:insert="fragments/header :: mainHeaderFragment" />

        <!-- nav       -->
        <th:block th:insert="fragments/nav :: navFragment" />


        <main>
            <!--SECTION01-->
            <section class="layout-5 breadcrumb-block">
                <div class="">
                    <nav style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item active" aria-current="page" style="border : 0px !important;">
                                <span class="material-symbols-outlined">home</span>
                            </li>
                        </ol>
                    </nav>
                </div>
            </section>

            <hr class="margin-top:15px;">
            <h5 class="layout-5" style="color : white;text-align:center;height:45px;line-height:45px;background-color:darkcyan">미리보기</h5>
            <hr>
<!--            <div th:text="${imageRankingPopular}"></div>-->
            <section class="section1 ">

                <div class="left layout-5">

                    <div class="ranking-summary">
                        <div class="title">
                            <h4 style="margin-bottom : 15px;">IMAGE RANKING TOP 10</h4>
                            <div>
                                <a href="" class="" >조회순</a>&nbsp;
                                <a href="" class="" >좋아요순</a>
                            </div>
                        </div>
                        <table class="table ">
                            <tr class="table-dark">
                                <th style="width:25px;">No</th>
                                <th>Image</th>
                                <th>Categoty</th>
                                <th style="width:25px;">Count</th>
                                <th style="width:25px;">Like</th>
                            </tr>
                            <tr class="" th:each="imageRanking,imageRankingStat : ${imageTop10ByCount}">


                                <td th:text="${imageRankingStat.count}"></td>
                                <td>
                                    <img  th:src="@{${imageRanking.ImagesFileInfo.dir}+'\s_'+${imageRanking.ImagesFileInfo.filename}}"></img>
                                </td>
                                <td th:text="${imageRanking.ImagesFileInfo.Images.subCategory}"></td>
                                <td th:text="${imageRanking.count}"></td>
                                <td th:text="${imageRanking.ilikeit}"></td>
                            </tr>
                        </table>
                    </div>

                </div>
                <div class="right layout-5">

                    <div class="tag">
                        IMAGE
                    </div>
                    <!-- Slider main container -->
                    <div class="swiper">
                        <!-- Additional required wrapper -->
                        <div class="swiper-wrapper">
                            <!-- Slides -->
                            <div class="swiper-slide"><canvas id="section1Chart"></canvas></div>
                            <div class="swiper-slide"><canvas id="section1Chart2"></canvas></div>
                        </div>

                        <!-- If we need navigation buttons -->
                        <div class="swiper-button-prev">
                            <span class="material-symbols-outlined" style="font-size:3rem;">arrow_left</span>
                        </div>
                        <div class="swiper-button-next">
                            <span class="material-symbols-outlined" style="font-size:3rem;">arrow_right</span>
                        </div>
                    </div>



                </div>


            </section>

            <!--SECTION02-->
            <hr class="margin-top:15px;">
            <h5 class="layout-5" style="color : white;text-align:center;height:45px;line-height:45px;background-color:darkcyan">경매</h5>
            <hr>
            <section class="section2 ">

                <div class="left layout-5">
                        <span style="font-size : 1rem;">이번주 경매일정</span> <a href="/trading/calendar/main"><span style="font-size : .7rem;font-weight:800;color:green">경매일정 전체보기 ></span></a>
                        <hr>
                    <div id='calendar' class="layout-5" style="height:300px;width:100%;"></div>
                </div>
                <div class="right layout-5">
                    <span style="font-size : 1rem;">진행중인 경매</span>
                    <hr>
                    <div class="images-block">
                        <!-- Slider main container -->
                        <div class="swiper">
                            <!-- Additional required wrapper -->
                            <div class="swiper-wrapper">
                                <!-- Slides -->
                                <div class="swiper-slide"><a href="">
                                    <span class="material-symbols-outlined">military_tech</span>
                                    <img src="">
                                </a></div>
                                <div class="swiper-slide"><a href=""><img src=""></a></div>
                                <div class="swiper-slide"><a href=""><img src=""></a></div>
                                <div class="swiper-slide"><a href=""><img src=""></a></div>
                                <div class="swiper-slide"><a href=""><img src=""></a></div>
                                <div class="swiper-slide"><a href=""><img src=""></a></div>
                                <div class="swiper-slide"><a href=""><img src=""></a></div>
                            </div>
                            <!-- If we need navigation buttons -->
                            <div class="swiper-button-prev">
                                <span class="material-symbols-outlined">arrow_left</span>
                            </div>
                            <div class="swiper-button-next">
                                <span class="material-symbols-outlined">arrow_right</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>


            <!--
            <section class="section2 ">
                <div class="left layout-5">
                    <canvas id=""></canvas>
                </div>
                <div class="right layout-5"></div>
            </section>
            -->


        </main>


        <!-- Footer        -->
        <footer>
            <th:block th:insert="fragments/footer :: footerFragment" />
        </footer>

    </div>




</body>
</html>